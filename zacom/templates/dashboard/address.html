{% extends 'user_templates/base.html' %}



{% block content %}
{% load static %}
z
<style>
    .custom-btn {
  background-color: #ee7c7c; /* Change background color */
  color: #fff; /* Change text color */
  border-radius: 5px; /* Add rounded corners */
  padding: 10px 20px; /* Add padding */
  border: none; /* Remove border */
  cursor: pointer; /* Add pointer cursor on hover */
  transition: background-color 0.3s ease; /* Add smooth transition for background color */
}

.custom-btn:hover {
  background-color: #ca1515; /* Change background color on hover */
}

    /* Override Bootstrap classes */
    .bg-danger {
      background-color: #ca1515 !important; /* Change background color to grey */
    }
  
    .nav-link {
      color: rgb(24, 24, 43) !important; /* Change text color to blue */
    }
  
    .nav-link.active {
      background-color: #ca1515 !important; /* Change background color of active link to grey */
      color: rgb(255, 255, 255) !important; /* Change text color of active link to blue */
    }
  </style>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
<script>

    
function delete_add(addressId){

    fetch(`/delete-address/?id=${addressId}`, {
    method: 'GET',
    headers: {
    'Content-Type': 'application/json',
    // Other headers as needed
    },
    })
    .then(response => response.json())
    .then(data => {
    // Handle the response data
    console.log(data);
    window.location.reload();
    })
    .catch(error => {
        // Handle errors
    window.location.reload();
    console.error('Error:', error);
    });

}



function sweet_alert(addressId) {
    Swal.fire({
        title: "Are you sure?",
        text: "Make this your default address",
        icon: "question",
        showCancelButton: false,
        confirmButtonColor: "#b19361",
        cancelButtonColor: "#d33",
    
    }).then((result) => {
        // If the user confirms
        console.log(addressId);
        if (result.isConfirmed) {
            // Make a fetch request to update is_default in the backend
            fetch('/address/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken'), // Include CSRF token
                },
                // body: JSON.stringify({ 'addressId':addressId }),
                body: JSON.stringify({ 'addressId':addressId }),
            })
                .then(response => response.json())
                .then(data => {
                    // Handle the response from the server
                    console.log(data);
                    if (data.success) {
                        // Success message
                        Swal.fire('Success', data.message, 'success');
                    } else {
                        // Error message
                        Swal.fire('Error', data.message, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle other errors
                    Swal.fire('Error', 'An unexpected error occurred', 'error');
                });
        }

    });

}



function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            // Check if the cookie name matches the provided name
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

document.getElementById("add-form-button").addEventListener("click", function() {
    // Toggle the display of form elements
    var address = document.getElementById("new-address-form");
    var addresslist = document.getElementById("address-list");
    if (address.style.display == 'block') {
        address.style.display = 'none'; 
        addresslist.style.display='block';
    } else {
        address.style.display = 'block'; 
        addresslist.style.display='none';
    }
});

// Create a new form submission event listener
document.getElementById("new-address-form").addEventListener("submit", function(event) {
    event.preventDefault(); // Prevent default form submission behavior

    // Collect form data
    var formData = new FormData(this);

    var csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;

    // Send form data via AJAX
    fetch("/address/add/", {
        method: "POST",
        headers: {
            "X-CSRFToken": csrfToken
        },
        body: formData
    })
    .then(response => {
        // Handle response as needed
        console.log("Form submitted successfully");
        // Optionally, you can update the UI or perform any other action based on the response
        window.location.reload();
    })
    .catch(error => {
        console.error("Error submitting form:", error);
        // Handle error as needed
    });
});

function validateusername() {
 
    const lastName = document.getElementById('nameInput').value.trim();
    const lastNameError = document.getElementById('nameError');

    if (lastName === "") {
        lastNameError.innerHTML = 'Enter your name';
        return false;
    }
    // Check if last name contains only letters and spaces
    if (!lastName.match(/^[a-zA-Z\s]+$/)) {
        lastNameError.innerHTML = 'User name can only contain letters and spaces';
        return false;
    }
    lastNameError.innerHTML = null;
    return true;
}


function validatePhone() {
    const phone = document.getElementById('Phone').value.trim();
    const phoneError = document.getElementById('phoneError');

    if (phone === "") {
        phoneError.innerHTML = 'Enter your phone number';
        return false;
    }
    // Check if phone number consists of the same digit repeated 10 times
    if (/^(\d)\1{9}$/.test(phone)) {
        phoneError.innerHTML = 'Enter a valid number';
        return false;
    }
    // Check if phone number contains exactly 10 digits
    if (!phone.match(/^\d{10}$/)) {
        phoneError.innerHTML = 'Phone number must be 10 digits';
        return false;
    }
    phoneError.innerHTML = null;
    return true;
}


function validatePincode() {
    const phone = document.getElementById('pincode').value.trim();
    const phoneError = document.getElementById('pincodeError');

    if (phone === "") {
        phoneError.innerHTML = 'Enter your pincode';
        return false;
    }
    // Check if phone number consists of the same digit repeated 10 times
    if (/^(\d)\1{9}$/.test(phone)) {
        phoneError.innerHTML = 'Enter a valid number';
        return false;
    }
    // Check if phone number contains exactly 10 digits
    if (!phone.match(/^\d{6}$/)) {
        phoneError.innerHTML = 'must be 6 digits';
        return false;
    }
    phoneError.innerHTML = null;
    return true;
}



function validatecity() {
 
 const lastName = document.getElementById('city').value.trim();
 const lastNameError = document.getElementById('cityError');

 if (lastName ==="") {
     lastNameError.innerHTML = 'Enter your city';
     return false;
 }
 // Check if last name contains only letters and spaces
 if (!lastName.match(/^[a-zA-Z\s]+$/)) {
     lastNameError.innerHTML = 'invalid';
     return false;
 }
 lastNameError.innerHTML = null;
 return true;
}
function validatestate() {
 
 const lastName = document.getElementById('state').value.trim();
 const lastNameError = document.getElementById('stateError');

 if (lastName ==="") {
     lastNameError.innerHTML = 'Enter your state';
     return false;
 }
 // Check if last name contains only letters and spaces
 if (!lastName.match(/^[a-zA-Z\s]+$/)) {
     lastNameError.innerHTML = 'invalid';
     return false;
 }
 lastNameError.innerHTML = null;
 return true;
}
function validatecountry() {
 
 const lastName = document.getElementById('country').value.trim();
 const lastNameError = document.getElementById('countryError');

 if (lastName ==="") {
     lastNameError.innerHTML = 'Enter your country';
     return false;
 }
 // Check if last name contains only letters and spaces
 if (!lastName.match(/^[a-zA-Z\s]+$/)) {
     lastNameError.innerHTML = 'invalid';
     return false;
 }
 lastNameError.innerHTML = null;
 return true;
}



function validateForm() {
    const isValidUserName = validateusername();
    const isValidphone = validatePhone();
    const isValidpincode = validatePincode();
    const isValidcity = validatecity();
    const isValidstate = validatestate();
    const isValidcountry = validatecountry();
    return isValidUserName && isValidphone && isValidpincode && isValidcity && isValidstate && isValidcountry /* && other validation checks */;
}

</script>

{% endblock content %}



